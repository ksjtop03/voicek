현재 알고 계실진 모르겠지만, 플랫폼/채널인프라팀에서 운영할 예정인 지역화폐 DB에 이슈가 많은 상태입니다.

 

김상기M님께서 타 시스템 분석을 하실 때마다 저에게 유용하게 쓰라고 FW을 해주시는데

고객/경영 EPAS DBA분들께도 FW드리오니 운영 중 CPU High 현상 발견 시 해당 부분도 같이 생각하면 좋을 것 같습니다.

 

아래 설명 건 요약하면 다음과 같습니다.

 

1) 지역화폐 DB CPU High 현상 발생, 발생하여 DB 내부적으로 분석 결과 딱히 발견하지 못함

2) strace(OS Process 추적 명령어)로 분석 시clock_gettime이 대부분 CPU 점유를 차지 하고 있음

3) 해당 건을 곰곰히 생각해보니auto_explain.log_analyze = on으로 인해 발생한 것으로 보임

4) 이 옵션을 off하여 CPU High 현상이 개선되는 지 운영부서에서 확인한 결과, 해당 파라미터로 인해 문제가 발생한 것으로 원인 파악하여 종결

 

추후 CPU High 현상 시 딱히 문제가 없을 때 해당 파라미터 확인하는 것도 좋은 방법인 것 같습니다.

kt 표준으로 설치되는 PostgreSQL/EPAS는 off로 설치가 되기 때문에 이런 현상은 없을 가능성이 크지만 아래와 같이 확인 가능하오니 업무에 참고를 부탁 드립니다.

※ 지역화폐DB는 워낙 많은 DB SQL이 지연이 발생하여 일부로 김상기C님 on한 상태

-- 확인방법
show auto_explain.log_analyze;